theme(#legend.position="none",
title=element_text(size=12),
axis.text=element_text(size=12),
axis.title=element_text(size=12))
# Distribution of change in abundance during growth
growth %>%
ggplot(aes(x=log(start_abund), color=DOC)) +
geom_density(alpha=0.5) +
labs(x="ln Starting relational abundance", y="Kernel Density") +
theme_test() +
theme(#legend.position="none",
title=element_text(size=12),
axis.text=element_text(size=12),
axis.title=element_text(size=12))
growth %>%
ggplot(aes(x=log(start_abund), color=Innoculant)) +
geom_density(alpha=0.5) +
labs(x="ln Starting in relational abundance", y="Kernel Density") +
theme_test() +
theme(#legend.position="none",
title=element_text(size=12),
axis.text=element_text(size=12),
axis.title=element_text(size=12))
# Distribution of change in abundance during growth
growth %>%
ggplot(aes(x=log(end_abund), color=DOC)) +
geom_density(alpha=0.5) +
labs(x="ln Ending relational abundance", y="Kernel Density") +
theme_test() +
theme(#legend.position="none",
title=element_text(size=12),
axis.text=element_text(size=12),
axis.title=element_text(size=12))
growth %>%
ggplot(aes(x=log(end_abund), color=Innoculant)) +
geom_density(alpha=0.5) +
labs(x="ln Ending relational abundance", y="Kernel Density") +
theme_test() +
theme(#legend.position="none",
title=element_text(size=12),
axis.text=element_text(size=12),
axis.title=element_text(size=12))
head(growth)
k_lmer <- lmer(k ~ DOC, data=growth)
k_lmer <- lmer(k ~ DOC + (1|Innoculant), data=growth)
hist(resid(klmer))
hist(resid(k_lmer))
plot(predict(k_lmer), resid(k_lmer))
k_lmer <- lmer(log(k) ~ DOC + (1|Innoculant), data=growth)
hist(resid(k_lmer))
plot(predict(k_lmer), resid(k_lmer))
summary(k_lmer)
start_day_lmer <- lmer(log(start_day) ~ DOC + (1|Innoculant), data=growth)
start_day_lmer <- lmer(start_day ~ DOC + (1|Innoculant), data=growth)
hist(resid(start_day_lmer))
plot(predict(start_day_lmer), resid(start_day_lmer))
hist(resid(start_day_lmer))
summary(start_day_lmer)
head(growth)
head(growth_summary)
k_lmer <- lmer(log(k) ~ DOC + (1|Innoculant), data=growth_summary)
k_lmer <- lmer(log(mean_k) ~ DOC + (1|Innoculant), data=growth_summary)
growth_summary$DOC
k_lm <- lm(log(mean_k ~ DOC, data=growth_summary)
k_lm <- lm(log(mean_k ~ DOC, data=growth_summary)
k_lm <- lm(mean_k ~ DOC, data=growth_summary)
hist(resid(k_lm))
plot(predict(k_lm), resid(k_lm))
anova(k_lm)
start_day_lm <- lm(mean_start_day ~ DOC, data=growth_summary)
hist(resid(start_day_lm))
plot(predict(start_day_lm), resid(start_day_lm))
anova(start_day_lm)
mean_change_lm <- lm(mean_mean_change ~ DOC, data=growth_summary)
growth_summary
mean_change_lm <- lm(mean_change_abund ~ DOC, data=growth_summary)
hist(resid(mean_change_lm))
plot(predict(mean_change_lm), resid(mean_change_lm))
mean_change_lm <- lm(log(mean_change_abund) ~ DOC, data=growth_summary)
hist(resid(mean_change_lm))
plot(predict(mean_change_lm), resid(mean_change_lm))
anova(mean_change_lm)
total_change_lm <- lm(total_change_abund ~ DOC, data=growth_summary)
hist(resid(total_change_lm))
plot(predict(total_change_lm), resid(total_change_lm))
anova(total_change_lm)
mean_change_lm <- lm(mean_change_abund ~ DOC, data=growth_summary)
hist(resid(mean_change_lm))
plot(predict(mean_change_lm), resid(mean_change_lm))
total_change_lm <- lm(log(total_change_abund) ~ DOC, data=growth_summary)
hist(resid(total_change_lm))
total_change_lm <- lm(total_change_abund ~ DOC, data=growth_summary)
hist(resid(total_change_lm))
plot(predict(total_change_lm), resid(total_change_lm))
anova(total_change_lm)
slope_lm <- lm(mean_slope ~ DOC, data=death_summary)
# Clear working directory, load in packages, generate package info
rm(list=ls())
library("tidyverse")
library("trelliscopejs")
sessionInfo()
# death
death <- readRDS("../data_intermediate/SFA2_death_estimates.rds")
# Taxonomic information
tax <- readRDS("../data_intermediate/SFA2_tax_normalized.rds")
# Number of taxa dying
num_grow <- death %>%
group_by(DOC, Innoculant) %>%
summarize(num_grew = n()) %>%
ungroup()
num_grow
# treatment
num_grow %>%
group_by(DOC) %>%
summarize(mean_num = mean(num_grew), sd_num = sd(num_grew)) %>%
ungroup()
num_grow %>%
ggplot(aes(x=DOC, y=num_grew)) +
geom_boxplot() +
labs(x="DOC \"phenotype\"", y="Number of death estimated taxa") +
theme_test() +
theme()
growth <- readRDS("../data_intermediate/SFA2_growth_estimates.rds")
growth_death <- death %>%
inner_join(growth, by=c("DOC", "Innoculant", "ASV")) %>%
select(DOC, Innoculant, ASV)
# Innoculant
growth_death %>%
group_by(DOC, Innoculant) %>%
summarize(number = n()) %>%
ungroup()
# Treatment
growth_death %>%
group_by(DOC, Innoculant) %>%
summarize(number = n()) %>%
ungroup() %>%
group_by(DOC) %>%
summarize(mean_num = mean(number), sd_num = sd(number)) %>%
ungroup()
# Merge death estimates with taxonomy
death_tax <- inner_join(death, tax)
# Graph phylogenetic membership
death_phylo_plot <- death_tax %>%
group_by(Phylum, DOC, Innoculant) %>%
summarize(count = n()) %>%
ungroup() %>%
arrange(count) %>%
ggplot(aes(x=count, y=reorder(Phylum, count), color=DOC)) +
geom_boxplot() +
labs(title="Death", y="", x="Number of ASVs") +
theme_test() +
theme(title = element_text(size=18),
axis.title = element_text(size=16),
axis.text = element_text(size=14))
death_phylo_plot
# Summarize parameters
death_summary <- death %>%
group_by(DOC, Innoculant) %>%
summarize(mean_slope = mean(slope),
mean_start_day = mean(start_day),
mean_end_day = mean(end_day),
mean_end_abund = mean(end_abund),
total_end_abund = sum(end_abund),
mean_change_abund = mean(change_abund),
total_change_abund = sum(change_abund)) %>%
ungroup()
# Mean k
slope_mean_plot <- death_summary %>%
ggplot(aes(x=DOC, y=mean_slope)) +
geom_boxplot() +
labs(x="DOC \"phenotype\"", y="Mean slope of death") +
theme_test() +
theme(title = element_text(size=18),
axis.title = element_text(size=16),
axis.text = element_text(size=14))
slope_mean_plot
# Mean start day
lag_mean_plot <- death_summary %>%
ggplot(aes(x=DOC, y=mean_start_day)) +
geom_boxplot() +
labs(x="DOC \"phenotype\"", y="Mean start of death (day)") +
theme_test() +
theme(title = element_text(size=18),
axis.title = element_text(size=16),
axis.text = element_text(size=14))
lag_mean_plot
# Mean change abundance
change_abund_mean_plot <- death_summary %>%
ggplot(aes(x=DOC, y=mean_change_abund)) +
geom_boxplot() +
labs(x="DOC \"phenotype\"", y="Mean change in relational abundance") +
theme_test() +
theme(title = element_text(size=18),
axis.title = element_text(size=14),
axis.text = element_text(size=14))
change_abund_mean_plot
# Total change abundance
change_abund_total_plot <- death_summary %>%
ggplot(aes(x=DOC, y=total_change_abund)) +
geom_boxplot() +
labs(x="DOC \"phenotype\"", y="Total change in relational abundance") +
theme_test() +
theme(title = element_text(size=18),
axis.title = element_text(size=14),
axis.text = element_text(size=14))
change_abund_total_plot
# Clear working directory, load in packages, generate package info
rm(list=ls())
library("tidyverse")
library("trelliscopejs")
sessionInfo()
# death
death <- readRDS("../data_intermediate/SFA2_death_estimates.rds")
# Taxonomic information
tax <- readRDS("../data_intermediate/SFA2_tax_normalized.rds")
# Number of taxa dying
num_grow <- death %>%
group_by(DOC, Innoculant) %>%
summarize(num_grew = n()) %>%
ungroup()
num_grow
# treatment
num_grow %>%
group_by(DOC) %>%
summarize(mean_num = mean(num_grew), sd_num = sd(num_grew)) %>%
ungroup()
num_grow %>%
ggplot(aes(x=DOC, y=num_grew)) +
geom_boxplot() +
labs(x="DOC \"phenotype\"", y="Number of death estimated taxa") +
theme_test() +
theme()
growth <- readRDS("../data_intermediate/SFA2_growth_estimates.rds")
growth_death <- death %>%
inner_join(growth, by=c("DOC", "Innoculant", "ASV")) %>%
select(DOC, Innoculant, ASV)
# Innoculant
growth_death %>%
group_by(DOC, Innoculant) %>%
summarize(number = n()) %>%
ungroup()
# Treatment
growth_death %>%
group_by(DOC, Innoculant) %>%
summarize(number = n()) %>%
ungroup() %>%
group_by(DOC) %>%
summarize(mean_num = mean(number), sd_num = sd(number)) %>%
ungroup()
# Merge death estimates with taxonomy
death_tax <- inner_join(death, tax)
# Graph phylogenetic membership
death_phylo_plot <- death_tax %>%
group_by(Phylum, DOC, Innoculant) %>%
summarize(count = n()) %>%
ungroup() %>%
arrange(count) %>%
ggplot(aes(x=count, y=reorder(Phylum, count), color=DOC)) +
geom_boxplot() +
labs(title="Death", y="", x="Number of ASVs") +
theme_test() +
theme(title = element_text(size=18),
axis.title = element_text(size=16),
axis.text = element_text(size=14))
death_phylo_plot
# Summarize parameters
death_summary <- death %>%
group_by(DOC, Innoculant) %>%
summarize(mean_slope = mean(slope),
mean_start_day = mean(start_day),
mean_end_day = mean(end_day),
mean_end_abund = mean(end_abund),
total_end_abund = sum(end_abund),
mean_change_abund = mean(change_abund),
total_change_abund = sum(change_abund)) %>%
ungroup()
# Mean k
slope_mean_plot <- death_summary %>%
ggplot(aes(x=DOC, y=mean_slope)) +
geom_boxplot() +
labs(x="DOC \"phenotype\"", y="Mean slope of death") +
theme_test() +
theme(title = element_text(size=18),
axis.title = element_text(size=16),
axis.text = element_text(size=14))
slope_mean_plot
# Mean start day
lag_mean_plot <- death_summary %>%
ggplot(aes(x=DOC, y=mean_start_day)) +
geom_boxplot() +
labs(x="DOC \"phenotype\"", y="Mean start of death (day)") +
theme_test() +
theme(title = element_text(size=18),
axis.title = element_text(size=16),
axis.text = element_text(size=14))
lag_mean_plot
# Mean change abundance
change_abund_mean_plot <- death_summary %>%
ggplot(aes(x=DOC, y=mean_change_abund)) +
geom_boxplot() +
labs(x="DOC \"phenotype\"", y="Mean change in relational abundance") +
theme_test() +
theme(title = element_text(size=18),
axis.title = element_text(size=14),
axis.text = element_text(size=14))
change_abund_mean_plot
# Total change abundance
change_abund_total_plot <- death_summary %>%
ggplot(aes(x=DOC, y=total_change_abund)) +
geom_boxplot() +
labs(x="DOC \"phenotype\"", y="Total change in relational abundance") +
theme_test() +
theme(title = element_text(size=18),
axis.title = element_text(size=14),
axis.text = element_text(size=14))
change_abund_total_plot
slope_lm <- lm(mean_slope ~ DOC, data=death_summary)
hist(resid(slope_lm))
plot(predict(slope_lm), resid(slope_lm))
anova(slope_lm)
slope_lm <- lm(log(mean_slope) ~ DOC, data=death_summary)
slope_lm <- lm(log(mean_slope) ~ DOC, data=death_summary)
start_day_lm <- lm(mean_start_day ~ DOC, data=death_summary)
hist(resid(start_day_lm))
plot(predict(start_day_lm), resid(start_day_lm))
anova(start_day_lm)
mean_change_lm <- lm(log(mean_change_abund) ~ DOC, data=death_summary)
mean_change_lm <- lm(mean_change_abund ~ DOC, data=death_summary)
hist(resid(mean_change_lm))
plot(predict(mean_change_lm), resid(mean_change_lm))
mean_change_lm <- lm(log(mean_change_abund) ~ DOC, data=death_summary)
mean_change_lm <- lm(mean_change_abund ~ DOC, data=death_summary)
hist(resid(mean_change_lm))
plot(predict(mean_change_lm), resid(mean_change_lm))
anova(mean_change_lm)
total_change_lm <- lm(total_change_abund ~ DOC, data=death_summary)
hist(resid(total_change_lm))
plot(predict(total_change_lm), resid(total_change_lm))
anova(total_change_lm)
# Clear working directory, load in packages, generate package info
rm(list=ls())
library("tidyverse")
library("trelliscopejs")
library("lmerTest")
sessionInfo()
# Growth
growth <- readRDS("../data_intermediate/SFA2_growth_estimates.rds")
# Taxonomic information
tax <- readRDS("../data_intermediate/SFA2_tax_normalized.rds")
# Number of taxa growing
num_grow <- growth %>%
group_by(DOC, Innoculant) %>%
summarize(num_grew = n()) %>%
ungroup()
num_grow
# treatment
num_grow %>%
group_by(DOC) %>%
summarize(mean_num = mean(num_grew), sd_num = sd(num_grew)) %>%
ungroup()
num_grow %>%
ggplot(aes(x=DOC, y=num_grew)) +
geom_boxplot() +
labs(x="DOC \"phenotype\"", y="Number of growth estimated taxa") +
theme_test()
# Merge growth estimates with taxonomy
growth_tax <- inner_join(growth, tax)
# Graph phylogenetic membership
growth_phylo_plot <- growth_tax %>%
group_by(Phylum, DOC, Innoculant) %>%
summarize(count = n()) %>%
ungroup() %>%
arrange(count) %>%
ggplot(aes(x=count, y=reorder(Phylum, count), color=DOC)) +
geom_boxplot() +
labs(title="Growth", y="", x="Number of ASVs") +
theme_test() +
theme(title = element_text(size=18),
axis.title = element_text(size=16),
axis.text = element_text(size=14))
growth_phylo_plot
# Merge growth estimates with taxonomy
growth_tax <- inner_join(growth, tax)
# Graph phylogenetic membership
growth_phylo_plot <- growth_tax %>%
group_by(Phylum, DOC, Innoculant) %>%
summarize(count = n()) %>%
ungroup() %>%
arrange(count) %>%
ggplot(aes(x=count, y=reorder(Phylum, count), color=DOC)) +
geom_boxplot() +
labs(title="Growth", y="", x="Number of ASVs") +
theme_test() +
theme(title = element_text(size=18),
axis.title = element_text(size=16),
axis.text = element_text(size=14),
panel.grid.major.y = element_line(size = 0.5,
linetype = 2))
growth_phylo_plot
# Graph phylogenetic membership
growth_phylo_plot <- growth_tax %>%
group_by(Phylum, DOC, Innoculant) %>%
summarize(count = n()) %>%
ungroup() %>%
arrange(count) %>%
ggplot(aes(x=count, y=reorder(Phylum, count), color=DOC)) +
geom_boxplot() +
labs(title="Growth", y="", x="Number of ASVs") +
theme_test() +
theme(title = element_text(size=18),
axis.title = element_text(size=16),
axis.text = element_text(size=14),
panel.grid.minor.y = element_line(size = 0.5,
linetype = 2))
growth_phylo_plot
# Graph phylogenetic membership
growth_phylo_plot <- growth_tax %>%
group_by(Phylum, DOC, Innoculant) %>%
summarize(count = n()) %>%
ungroup() %>%
arrange(count) %>%
ggplot(aes(x=count, y=reorder(Phylum, count), color=DOC)) +
geom_boxplot() +
labs(title="Growth", y="", x="Number of ASVs") +
theme_test() +
theme(title = element_text(size=18),
axis.title = element_text(size=16),
axis.text = element_text(size=14),
panel.grid.major.y = element_line(color = "gray",
size = 0.5,
linetype = 2))
growth_phylo_plot
ggsave("../figures/SFA2_growth_phylo.png", growth_phylo_plot, units="mm", width=200, height=100)
# Clear working directory, load in packages, generate package info
rm(list=ls())
library("tidyverse")
library("trelliscopejs")
sessionInfo()
# death
death <- readRDS("../data_intermediate/SFA2_death_estimates.rds")
# Taxonomic information
tax <- readRDS("../data_intermediate/SFA2_tax_normalized.rds")
# Number of taxa dying
num_grow <- death %>%
group_by(DOC, Innoculant) %>%
summarize(num_grew = n()) %>%
ungroup()
num_grow
# treatment
num_grow %>%
group_by(DOC) %>%
summarize(mean_num = mean(num_grew), sd_num = sd(num_grew)) %>%
ungroup()
num_grow %>%
ggplot(aes(x=DOC, y=num_grew)) +
geom_boxplot() +
labs(x="DOC \"phenotype\"", y="Number of death estimated taxa") +
theme_test() +
theme()
growth <- readRDS("../data_intermediate/SFA2_growth_estimates.rds")
growth_death <- death %>%
inner_join(growth, by=c("DOC", "Innoculant", "ASV")) %>%
select(DOC, Innoculant, ASV)
# Innoculant
growth_death %>%
group_by(DOC, Innoculant) %>%
summarize(number = n()) %>%
ungroup()
# Treatment
growth_death %>%
group_by(DOC, Innoculant) %>%
summarize(number = n()) %>%
ungroup() %>%
group_by(DOC) %>%
summarize(mean_num = mean(number), sd_num = sd(number)) %>%
ungroup()
# Merge death estimates with taxonomy
death_tax <- inner_join(death, tax)
# Graph phylogenetic membership
death_phylo_plot <- death_tax %>%
group_by(Phylum, DOC, Innoculant) %>%
summarize(count = n()) %>%
ungroup() %>%
arrange(count) %>%
ggplot(aes(x=count, y=reorder(Phylum, count), color=DOC)) +
geom_boxplot() +
labs(title="Death", y="", x="Number of ASVs") +
theme_test() +
theme(title = element_text(size=18),
axis.title = element_text(size=16),
axis.text = element_text(size=14))
death_phylo_plot
# Merge death estimates with taxonomy
death_tax <- inner_join(death, tax)
# Graph phylogenetic membership
death_phylo_plot <- death_tax %>%
group_by(Phylum, DOC, Innoculant) %>%
summarize(count = n()) %>%
ungroup() %>%
arrange(count) %>%
ggplot(aes(x=count, y=reorder(Phylum, count), color=DOC)) +
geom_boxplot() +
labs(title="Death", y="", x="Number of ASVs") +
theme_test() +
theme(title = element_text(size=18),
axis.title = element_text(size=16),
axis.text = element_text(size=14),
panel.grid.major.y = element_line(color = "gray",
size = 0.5,
linetype = 2))
death_phylo_plot
ggsave("../figures/SFA2_death_phylo.png", death_phylo_plot, units="mm", width=200, height=100)
