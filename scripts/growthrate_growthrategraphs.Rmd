---
title: "Growth Rate, Lots of graphs"
author: "Cassi Wattenburger"
date: "4/9/2019"
output: 
  html_document:
    self_contained: false
    lib_dir: rmarkdown_files
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Background:** The goal of this project was to develop an in-situ growth rate method for soil bacteria using sequencing data, and relating that information back to life history traits in microbial communities in successional vs cropped soils. Samples were taken from the Dunlop site from all treatments (monocropped yeras 1, 2, 3, and successional years 1, 2, 3, 4, 5, 6, 17) and sequenced as-is. Additional soil was taken from the treatments cropped year 3 and successional year 17 to set up microcosms for in-situ growth rate calculation. Soils were put in petri-dish microcosms, with or without C ammendment, and incubated for two months.

**Goal of this script:** Graph all taxa that met criteria.

```{r, include=FALSE}
# Import packages, clear workspace, set working directory yada yada
rm(list=ls())

setwd("/home/cassi/growthrate2018")

library("ggplot2")
library("gapminder")
library("trelliscopejs")
```

```{r, echo=FALSE}
sessionInfo()
```

```{r, include=FALSE}

#import data
load("r.output/gr_pruned.norm.RData")
```

```{r, include=FALSE}

# subset data for quicker troubleshooting
pruned.subset <- pruned.norm[1:240,]
```

```{r, echo=FALSE, include=FALSE}
write.csv(pruned.subset, file="pruned.subset.csv")
```

```{r, echo=FALSE}

growth.graph <- ggplot(pruned.norm, aes(x=Days, y=mean, color=Cammend, alpha=Cammend)) +
  geom_point() +
  geom_line() +
  geom_errorbar(aes(ymin=mean-se, ymax=mean+se), alpha=0.5) +
  facet_wrap(~Soil) +
  facet_trelliscope(~variable, scales="free_y", path="rmarkdown_files", self_contained=TRUE, height = 400, width = 1600) +
  labs(x="Days", y="Normalized abundance") +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  guides(color=guide_legend(title="C added? Y/N"))
growth.graph

```

```{r, echo=FALSE}
#growth.graphs <- list()

#for (i in unique(pruned.subset$variable)) {
  #growth.graphs[[i]] <- ggplot(pruned.subset[pruned.subset$variable==i,], aes(x=TimePoint, y=mean, color=Cammend, alpha=Cammend)) +
    #geom_point() +
    #geom_line() +
    #geom_errorbar(aes(ymin=mean-sd, ymax=mean-sd), alpha=0.5) +
    #facet_wrap(~Soil)
    #labs(x="Time point", y="Normalized abundance") +
    #theme(axis.text.x = element_text(angle=45, hjust=1)) +
    #guides(color=guide_legend(title="C added? Y/N"))
#}

```

